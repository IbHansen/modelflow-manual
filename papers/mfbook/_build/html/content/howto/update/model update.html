
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6. Update, modifying series in a dataframe using modelflow &#8212; Some models in Python with ModelFlow</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="7. Extend Pandas dataframes with ModelFLow capabilities." href="extending_dataframes.html" />
    <link rel="prev" title="5. Introduction to Pandas dataframes" href="../../notebooks/pandas/dataframes.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Some models in Python with ModelFlow</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../introduction.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Model, solutions and Modelflow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/intro/model%20and%20solution.html">
   1. What is a Model in ModelFlow ?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/intro/Example%20Solow.html">
   3. Example Solow model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python and pandas stuff
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/Intro_Jupyter_notebook.html">
   4. Introduction to the Jupyter Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/pandas/dataframes.html">
   5. Introduction to Pandas dataframes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Updating variables
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   6. Update, modifying series in a dataframe using modelflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="extending_dataframes.html">
   7. Extend Pandas dataframes with ModelFLow capabilities.
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  A small demo model
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../smallmodel/modelstart.html">
   8. Create a small model from scratch and save it
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../smallmodel/modelstart%20export%20up.html">
   9. Experiment: Export up
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Make experiments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../experiments/create_experiment.html">
   10. Create an experiment, simulate it and access results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../experiments/create_save_scenarios.html">
   12. Create many scenarios, simulate them  and access results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../experiments/Standard%20experiment%20simple.html">
   13. A experiment using Taxes on Goods and Services
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Keept experiments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../keep/Create%20and%20modify%20charts%20with%20keep_plot.html">
   14. Load a model and data inclusive the keept scenarios
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Onboarding MFMod models from .wf1
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../onboard/eviews/onboard%20one%20model%20from%20%20wf1.html">
   15. Onboard a model defined in a .wf1 file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onboard/eviews/onboard%20many%20models%20from%20wf1.html">
   16. Onboard all models  defined in .wf1 files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onboard/eviews/Normalizing%20when%20onboarding%20eviews.html">
   17. Normalizing when onboarding  eviews models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  modifying models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../fixing/Fixing%20variables.html">
   18. Fixing the value of variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../modifymodel/create_real_model.html">
   19. Modified equation to to keep real tax rates
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Features
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/modelflow_features.html">
   21. Useful model instance properties and methods
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Structure
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../structure/Logical_structure.html">
   22. Logical structure and dependencies.
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Attribution
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../attribution/Attribution%20background.html">
   23. Attribution
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Target and instruments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../targetinstruments/One%20target%20one%20instrument%20with%203%20instrument%20variables.html">
   24. One target one instrument with 3 instrument variables
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Specification
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/intro/model%20specification.html">
   25. Specification of models (introduction)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Optimization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../optimization/Optimize_simpel.html">
   26. Mean variance optimization
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  More
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../litterature.html">
   27. Litterature
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/IbHansen/modelflow-manual/main?urlpath=tree/papers/mfbook/content/howto/update/model update.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/IbHansen/modelflow-manual/blob/main/papers/mfbook/content/howto/update/model update.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/content/howto/update/model update.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-up-the-workspace">
   6.1. Setting up the workspace
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-dataframe-to-update">
   6.2. Create dataframe to update:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-dataframe-loc-to-make-a-new-variable">
   6.3. Use dataframe.loc to make a new variable
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-dataframe-upd-to-modify-a-series-in-a-dataframe-or-to-add-a-series-to-a-dataframe">
   6.4. Use dataframe.upd()  to  modify a series in a dataframe or to add a series to a dataframe
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-value-equal-to-input">
     6.4.1. = Setting value equal to input
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#creates-a-new-data-series-called-c-in-the-dataframe-with-values-of-142-everywhere">
       6.4.1.1. Creates a new data series called c in the dataframe with values of 142 everywhere
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#setting-specific-datapoints-to-specific-values">
       6.4.1.2. Setting specific datapoints to specific values
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-the-specified-values-to-all-values-in-a-range-the-operator">
     6.4.2. Adding  the specified  values to all values in a range (the + operator)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiplying-all-values-in-a-range-by-the-specified-values-the-operator">
     6.4.3. Multiplying all values in a range by the specified values (the * operator)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#increasing-all-values-in-a-range-by-a-specified-percent-amount-the-operator">
     6.4.4. Increasing all  values in a range by a  specified percent amount (the % operator)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-the-percent-growth-rate-to-specified-values-growth">
     6.4.5. Set the percent growth rate to specified values (=GROWTH)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-or-subtract-from-the-existing-percent-growth-rate-growth-operator">
     6.4.6. Add or subtract from the existing percent growth rate (+GROWTH operator)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-delta-var-t-var-t-1-to-specified-values-diff-operator">
     6.4.7. Set
     <span class="math notranslate nohighlight">
      \(\Delta = var_t - var_{t-1}\)
     </span>
     to specified values (=diff operator)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recall-that-we-have-not-overwritten-df-so-the-df-dataframe-is-unchanged">
     6.4.8. Recall  that we have not overwritten df, so the df dataframe is unchanged.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#upd-keep-growth-keep-growth-keep-the-growth-rate-in-the-years-after-the-update">
   6.5. .upd(,,,keep_growth)/–keep_growth, keep the growth rate in the years after the update
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-make-a-dataframe-with-some-growth-rate">
     6.5.1. First make a dataframe with some growth rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#now-update-a-in-2021-to-2023-to-a-new-value">
     6.5.2. now update A in 2021 to 2023 to a new value,
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-more-advanced-example">
     6.5.3. A more advanced example
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#first-create-a-string-with-update-lines">
       6.5.3.1. First create a string with update lines
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-the-update-lines-to-update-a-dataframe">
       6.5.3.2. Use the update lines to update a dataframe
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#update-the-new-dataframe-and-keep-some-of-the-growth-rates">
       6.5.3.3. Update the new dataframe and keep some of the growth rates
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kg-can-replace-keep-growth-and-nkg-can-replace-non-keep-growth">
     6.5.4. –kg can replace –keep_growth and –nkg can replace –non_keep_growth
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#update-several-variable-in-one-line">
   6.6. Update several variable in one line
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#upd-scale-number-default-1-scale-the-updates">
   6.7. .upd(,,scale=&lt;number, default=1&gt;) Scale the updates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#upd-lprint-true-prints-vaues-the-before-and-after-update">
   6.8. .upd(,,lprint=True ) prints vaues the before and after update
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#upd-create-true-requires-the-variable-to-exist">
   6.9. .upd(,,create=True ) Requires the variable to exist
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-call">
   6.10. The call
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Update, modifying series in a dataframe using modelflow</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-up-the-workspace">
   6.1. Setting up the workspace
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-dataframe-to-update">
   6.2. Create dataframe to update:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-dataframe-loc-to-make-a-new-variable">
   6.3. Use dataframe.loc to make a new variable
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-dataframe-upd-to-modify-a-series-in-a-dataframe-or-to-add-a-series-to-a-dataframe">
   6.4. Use dataframe.upd()  to  modify a series in a dataframe or to add a series to a dataframe
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-value-equal-to-input">
     6.4.1. = Setting value equal to input
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#creates-a-new-data-series-called-c-in-the-dataframe-with-values-of-142-everywhere">
       6.4.1.1. Creates a new data series called c in the dataframe with values of 142 everywhere
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#setting-specific-datapoints-to-specific-values">
       6.4.1.2. Setting specific datapoints to specific values
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-the-specified-values-to-all-values-in-a-range-the-operator">
     6.4.2. Adding  the specified  values to all values in a range (the + operator)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiplying-all-values-in-a-range-by-the-specified-values-the-operator">
     6.4.3. Multiplying all values in a range by the specified values (the * operator)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#increasing-all-values-in-a-range-by-a-specified-percent-amount-the-operator">
     6.4.4. Increasing all  values in a range by a  specified percent amount (the % operator)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-the-percent-growth-rate-to-specified-values-growth">
     6.4.5. Set the percent growth rate to specified values (=GROWTH)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-or-subtract-from-the-existing-percent-growth-rate-growth-operator">
     6.4.6. Add or subtract from the existing percent growth rate (+GROWTH operator)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-delta-var-t-var-t-1-to-specified-values-diff-operator">
     6.4.7. Set
     <span class="math notranslate nohighlight">
      \(\Delta = var_t - var_{t-1}\)
     </span>
     to specified values (=diff operator)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recall-that-we-have-not-overwritten-df-so-the-df-dataframe-is-unchanged">
     6.4.8. Recall  that we have not overwritten df, so the df dataframe is unchanged.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#upd-keep-growth-keep-growth-keep-the-growth-rate-in-the-years-after-the-update">
   6.5. .upd(,,,keep_growth)/–keep_growth, keep the growth rate in the years after the update
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-make-a-dataframe-with-some-growth-rate">
     6.5.1. First make a dataframe with some growth rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#now-update-a-in-2021-to-2023-to-a-new-value">
     6.5.2. now update A in 2021 to 2023 to a new value,
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-more-advanced-example">
     6.5.3. A more advanced example
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#first-create-a-string-with-update-lines">
       6.5.3.1. First create a string with update lines
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-the-update-lines-to-update-a-dataframe">
       6.5.3.2. Use the update lines to update a dataframe
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#update-the-new-dataframe-and-keep-some-of-the-growth-rates">
       6.5.3.3. Update the new dataframe and keep some of the growth rates
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kg-can-replace-keep-growth-and-nkg-can-replace-non-keep-growth">
     6.5.4. –kg can replace –keep_growth and –nkg can replace –non_keep_growth
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#update-several-variable-in-one-line">
   6.6. Update several variable in one line
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#upd-scale-number-default-1-scale-the-updates">
   6.7. .upd(,,scale=&lt;number, default=1&gt;) Scale the updates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#upd-lprint-true-prints-vaues-the-before-and-after-update">
   6.8. .upd(,,lprint=True ) prints vaues the before and after update
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#upd-create-true-requires-the-variable-to-exist">
   6.9. .upd(,,create=True ) Requires the variable to exist
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-call">
   6.10. The call
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="update-modifying-series-in-a-dataframe-using-modelflow">
<span id="upd"></span><h1><span class="section-number">6. </span>Update, modifying series in a dataframe using modelflow<a class="headerlink" href="#update-modifying-series-in-a-dataframe-using-modelflow" title="Permalink to this headline">#</a></h1>
<p>Often when we are working with a model we will want to modify individual data points or series in a model (for example when doing a simulation, or if there is a data update to one or more series.
This can be done straight using pandas methods.</p>
<p>However the <strong>dataframe.upd</strong> function in Modelflow simplifies this exercise.
It gives the user a concise and expressive way to specify
typical updates of economic variables.</p>
<p>A line like:</p>
<blockquote>
<div><p>newdf = df.upd(‘the_answer = 42’)</p>
</div></blockquote>
<p>will create a new dataframe based on the dataframe df where the variable <code class="docutils literal notranslate"><span class="pre">THE_ANSWER</span></code> has the value 42.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>The df dataframe remains unchanged. The newdf contains the new updated values (and all non-updated variables from df.</p>
</div>
<p>To make df.update useful you can also:</p>
<ul class="simple">
<li><p>Perform different types of  updates</p></li>
<li><p>Perform multiple updates each on a new line</p></li>
<li><p>Control the time for which the update has effect</p></li>
<li><p>Use one input which is used for all time frames, or a input for each time</p></li>
<li><p>Keep the growth rate after the update time frame</p></li>
<li><p>Display the results</p></li>
</ul>
<p><strong>Types of update:</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Update to perform</p></th>
<th class="text-align:left head"><p>Use this operator</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>Set a variable equal to the input</p></td>
<td class="text-align:left"><p>=</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Add the input to the input</p></td>
<td class="text-align:left"><p>+</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Set the variable to itself multiplied by the input</p></td>
<td class="text-align:left"><p>*</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Set the variable to itself multiplied by (1+input/100)</p></td>
<td class="text-align:left"><p>%</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Set the growth rate of the variable to the input</p></td>
<td class="text-align:left"><p>=growth</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Set the growth rate of the variable to the current growth rate plus the input</p></td>
<td class="text-align:left"><p>+growth</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Set <span class="math notranslate nohighlight">\(\Delta = var_t - var_{t-1}\)</span> of  the variable to the input</p></td>
<td class="text-align:left"><p>=diff</p></td>
</tr>
</tbody>
</table>
<p><em><strong>Setting the time scope</strong></em></p>
<p>The update command takes a variety of mathematical operators <code class="docutils literal notranslate"><span class="pre">=,</span> <span class="pre">+,</span> <span class="pre">\*,</span> <span class="pre">%</span> <span class="pre">=GROWTH,</span> <span class="pre">+GROWTH,</span> <span class="pre">=DIFF</span></code> and applies them to data for the period set in the leading &lt;&gt;.</p>
<ul class="simple">
<li><p>If <strong>one date</strong> is specified the operation is applied to a single point in time</p></li>
<li><p>If <strong>two dates</strong>  are specifies the operation is applied over a period of time.</p></li>
</ul>
<p>The time will persist until set next time. Useful to avoid visual noise if several variables are going to be updated for the same time period.</p>
<ul class="simple">
<li><p>To indicate the start of the dataframe use -0</p></li>
<li><p>To indicate the end of the dataframe use -1</p></li>
</ul>
<p>If no time is provided the dataframe start and end period will be used.</p>
<p><strong>Keep growth rates after the update time</strong></p>
<p>In a long projection it can sometime be useful to be able to update variables for which new information is available, but keep the growth rate the same as before the update  after the update time.</p>
<p>For each <em>update line</em> it is governed
by the <code class="docutils literal notranslate"><span class="pre">--keep_growth</span></code> and <code class="docutils literal notranslate"><span class="pre">--no_keep_growth</span></code> option.</p>
<p>For the <em>.update call</em> (which can contain many update lines) this is ruled by the <code class="docutils literal notranslate"><span class="pre">keep_growth</span></code> parameter.
The default value for <code class="docutils literal notranslate"><span class="pre">keep_growth</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>. If <code class="docutils literal notranslate"><span class="pre">keep_growth=True</span></code> all lines will use the <code class="docutils literal notranslate"><span class="pre">keep_growth</span></code>
except lines with the –no_keep_growth option</p>
<p>Examples later.</p>
<p><strong>Comments</strong></p>
<p>Everyting after a # until line end is regarded as a comment</p>
<section id="setting-up-the-workspace">
<h2><span class="section-number">6.1. </span>Setting up the workspace<a class="headerlink" href="#setting-up-the-workspace" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">modelclass</span> <span class="kn">import</span> <span class="n">model</span> 
<span class="n">model</span><span class="o">.</span><span class="n">widescreen</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">scroll_off</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
    div#notebook-container    { width: 95%; }
    div#menubar-container     { width: 65%; }
    div#maintoolbar-container { width: 99%; }
</style>
</div></div>
</div>
</section>
<section id="create-dataframe-to-update">
<h2><span class="section-number">6.2. </span>Create dataframe to update:<a class="headerlink" href="#create-dataframe-to-update" title="Permalink to this headline">#</a></h2>
<p>Now a pandas dataframe with one column and 6 rows are created. The column is has the name <code class="docutils literal notranslate"><span class="pre">A</span></code> and the rows have index 2020 to 2025.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">number_of_rows</span> <span class="o">=</span> <span class="mi">6</span> 
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span>
       <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2020</span><span class="o">+</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_rows</span><span class="p">)],</span> <span class="c1"># create row index</span>
       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>                                 <span class="c1"># create column name </span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>100</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>100</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> creates a dataframe  <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame">Description</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[2020+v</span> <span class="pre">for</span> <span class="pre">v</span> <span class="pre">in</span> <span class="pre">range(number_of_rows)]</span></code> defines a list comprehension which creates a list of the integers from 2020 to 2025 (see below for list comprehensions)</p></li>
</ul>
</section>
<section id="use-dataframe-loc-to-make-a-new-variable">
<h2><span class="section-number">6.3. </span>Use dataframe.loc to make a new variable<a class="headerlink" href="#use-dataframe-loc-to-make-a-new-variable" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.loc</span></code> is used to access or set values in a dataframe based on row and column labels.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html">Description</a></p></li>
<li><p><a class="reference external" href="https://www.google.com/search?q=pandas+dataframe+loc&amp;newwindow=1">Search</a></p></li>
</ul>
<p>A new series (a column) called B is set to 100</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;B&#39;</span> <span class="p">]</span> <span class="o">=</span> <span class="mf">100.</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="use-dataframe-upd-to-modify-a-series-in-a-dataframe-or-to-add-a-series-to-a-dataframe">
<h2><span class="section-number">6.4. </span>Use dataframe.upd()  to  modify a series in a dataframe or to add a series to a dataframe<a class="headerlink" href="#use-dataframe-upd-to-modify-a-series-in-a-dataframe-or-to-add-a-series-to-a-dataframe" title="Permalink to this headline">#</a></h2>
<p>Upd makes it much easier to create new series (compare the below, with the complicated pandas code above).</p>
<section id="setting-value-equal-to-input">
<h3><span class="section-number">6.4.1. </span>= Setting value equal to input<a class="headerlink" href="#setting-value-equal-to-input" title="Permalink to this headline">#</a></h3>
<section id="creates-a-new-data-series-called-c-in-the-dataframe-with-values-of-142-everywhere">
<h4><span class="section-number">6.4.1.1. </span>Creates a new data series called c in the dataframe with values of 142 everywhere<a class="headerlink" href="#creates-a-new-data-series-called-c-in-the-dataframe-with-values-of-142-everywhere" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;c = 142&#39;</span><span class="p">)</span> 
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100.0</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>100</td>
      <td>100.0</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>100</td>
      <td>100.0</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>100.0</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100.0</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100.0</td>
      <td>142.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="setting-specific-datapoints-to-specific-values">
<h4><span class="section-number">6.4.1.2. </span>Setting specific datapoints to specific values<a class="headerlink" href="#setting-specific-datapoints-to-specific-values" title="Permalink to this headline">#</a></h4>
<p>In this example, upd uses the equals operator.  This indicates that the variable a should be set equal to the indicated values following the = operator (42 44 45 46 in this example). The dates enclosed in &lt;&gt; indicate the period over which the change should be applied.</p>
<p>Either:</p>
<ul class="simple">
<li><p>The number of data points provided must match the number of dates in the period, Or</p></li>
<li><p>Only one data point is provided, it is applied to all dates in the period.</p></li>
</ul>
<p>If only one period is to be modified then it can be followed by just one date.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Same number of values as years</span>
<span class="s2">&lt;2021 2024&gt; A = 42 44 45 46    # 4 years</span>
<span class="s2">&lt;2020     &gt; B = 200            # 1 year </span>
<span class="s2">c = 500</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>200.0</td>
      <td>500.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>42</td>
      <td>100.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>44</td>
      <td>100.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>45</td>
      <td>100.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>46</td>
      <td>100.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="adding-the-specified-values-to-all-values-in-a-range-the-operator">
<h3><span class="section-number">6.4.2. </span>Adding  the specified  values to all values in a range (the + operator)<a class="headerlink" href="#adding-the-specified-values-to-all-values-in-a-range-the-operator" title="Permalink to this headline">#</a></h3>
<p>NB: Here upd with the  + operator indicates that we are adding 42.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Or one number to all years in between start and end </span>
<span class="s1">&lt;2022 2024&gt; B  +  42    # one value broadcast to 3 years </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>100</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="multiplying-all-values-in-a-range-by-the-specified-values-the-operator">
<h3><span class="section-number">6.4.3. </span>Multiplying all values in a range by the specified values (the * operator)<a class="headerlink" href="#multiplying-all-values-in-a-range-by-the-specified-values-the-operator" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Same number of values as years</span>
<span class="s1">&lt;2021 2023&gt; A *  42 44 55</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>4200</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>4400</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>5500</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="increasing-all-values-in-a-range-by-a-specified-percent-amount-the-operator">
<h3><span class="section-number">6.4.4. </span>Increasing all  values in a range by a  specified percent amount (the % operator)<a class="headerlink" href="#increasing-all-values-in-a-range-by-a-specified-percent-amount-the-operator" title="Permalink to this headline">#</a></h3>
<p>In this example:</p>
<ul class="simple">
<li><p>A is increased by 42 and 44% over the range 2021 through 2022.</p></li>
<li><p>B is increased by 10 percent in all years</p></li>
<li><p>C, a new variable, is created and set to 100 for the whole range</p></li>
<li><p>C is decreased by 12 percent over the range 2023 through 2025.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;2021 2022 &gt; A %  42 44   </span>
<span class="s1">&lt;-0 -1&gt; B % 10            # all rows </span>
<span class="s1">C = 100                   # all rows persist </span>
<span class="s1">&lt;2023 2025&gt; C % -12       # now only fo 3 years </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>110.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>142</td>
      <td>110.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>144</td>
      <td>110.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>110.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>110.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>110.0</td>
      <td>88.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="set-the-percent-growth-rate-to-specified-values-growth">
<h3><span class="section-number">6.4.5. </span>Set the percent growth rate to specified values (=GROWTH)<a class="headerlink" href="#set-the-percent-growth-rate-to-specified-values-growth" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Same number of values as years</span>
<span class="s1">&lt;2021 2022&gt; A =GROWTH  1 5  </span>
<span class="s1">&lt;2020&gt; c = 100 </span>
<span class="s1">&lt;2021 2025&gt; c =GROWTH 2 </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataframe:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># Explained b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataframe:
           A      B           C
2020  100.00  100.0  100.000000
2021  101.00  100.0  102.000000
2022  106.05  100.0  104.040000
2023  100.00  100.0  106.120800
2024  100.00  100.0  108.243216
2025  100.00  100.0  110.408080

Growth:
             A    B    C
2020       NaN  NaN  NaN
2021  1.000000  0.0  2.0
2022  5.000000  0.0  2.0
2023 -5.704856  0.0  2.0
2024  0.000000  0.0  2.0
2025  0.000000  0.0  2.0
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Python constructs</strong><br></p>
<blockquote>
<div><p>print(f’Dataframe:\n{res}\n\nGrowth:\n{res.pct_change()*100}\n’)</p>
</div></blockquote>
<p>Uses</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Python construct</p></th>
<th class="text-align:left head"><p>Explanation</p></th>
<th class="text-align:left head"><p>Links</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>‘\n’</p></td>
<td class="text-align:left"><p>A line break</p></td>
<td class="text-align:left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>dataframe.pct_change</p></td>
<td class="text-align:left"><p>Percentage change between the current and a prior element.</p></td>
<td class="text-align:left"><p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pct_change.html">Description</a></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>f’{varname} = ….’</p></td>
<td class="text-align:left"><p>A f-string, {expression} is replaced by the value of expression</p></td>
<td class="text-align:left"><p><a class="reference external" href="https://www.google.com/search?q=python+f-string&amp;newwindow=1">Search</a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="add-or-subtract-from-the-existing-percent-growth-rate-growth-operator">
<h3><span class="section-number">6.4.6. </span>Add or subtract from the existing percent growth rate (+GROWTH operator)<a class="headerlink" href="#add-or-subtract-from-the-existing-percent-growth-rate-growth-operator" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Same number of values as years</span>
<span class="s1">&lt;2021 2025&gt; A =GROWTH  1  </span>
<span class="s1"># now we add values  to the growth rate, </span>
<span class="s1">a +growth   2 3 4 5 6 </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataframe:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataframe:
               A      B
2020  100.000000  100.0
2021  103.000000  100.0
2022  107.120000  100.0
2023  112.476000  100.0
2024  119.224560  100.0
2025  127.570279  100.0

Growth:
        A    B
2020  NaN  NaN
2021  3.0  0.0
2022  4.0  0.0
2023  5.0  0.0
2024  6.0  0.0
2025  7.0  0.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-delta-var-t-var-t-1-to-specified-values-diff-operator">
<h3><span class="section-number">6.4.7. </span>Set <span class="math notranslate nohighlight">\(\Delta = var_t - var_{t-1}\)</span> to specified values (=diff operator)<a class="headerlink" href="#set-delta-var-t-var-t-1-to-specified-values-diff-operator" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Same number of values as years</span>
<span class="s1">&lt; 2021 2022&gt; A =diff  2 4   </span>
<span class="s1"># cv number to all years in between start and end </span>

<span class="s1">&lt;2020 &gt; same = 100 </span>
<span class="s1">&lt;2021 2025&gt; same =diff  2  </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>SAME</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>102</td>
      <td>100.0</td>
      <td>102.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>106</td>
      <td>100.0</td>
      <td>104.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>100.0</td>
      <td>106.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100.0</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100.0</td>
      <td>110.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="recall-that-we-have-not-overwritten-df-so-the-df-dataframe-is-unchanged">
<h3><span class="section-number">6.4.8. </span>Recall  that we have not overwritten df, so the df dataframe is unchanged.<a class="headerlink" href="#recall-that-we-have-not-overwritten-df-so-the-df-dataframe-is-unchanged" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="upd-keep-growth-keep-growth-keep-the-growth-rate-in-the-years-after-the-update">
<h2><span class="section-number">6.5. </span>.upd(,,,keep_growth)/–keep_growth, keep the growth rate in the years after the update<a class="headerlink" href="#upd-keep-growth-keep-growth-keep-the-growth-rate-in-the-years-after-the-update" title="Permalink to this headline">#</a></h2>
<p>Before a series is updated the growth rate of the series is calculated. After a series has been updated, it is possible to use the saved growth rate to do an automatic update of the series from the end of the “proper” update period until the end of the dataframe.</p>
<p>This allows to update variables for which new information is available, but keep the growth rate the same as before the update in the period after the update time.</p>
<section id="first-make-a-dataframe-with-some-growth-rate">
<h3><span class="section-number">6.5.1. </span>First make a dataframe with some growth rate<a class="headerlink" href="#first-make-a-dataframe-with-some-growth-rate" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&lt;2021 2025&gt; a =growth 1 2 3 4 5&#39;</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataframe:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataframe:
               A      B
2020  100.000000  100.0
2021  101.000000  100.0
2022  103.020000  100.0
2023  106.110600  100.0
2024  110.355024  100.0
2025  115.872775  100.0

Growth:
        A    B
2020  NaN  NaN
2021  1.0  0.0
2022  2.0  0.0
2023  3.0  0.0
2024  4.0  0.0
2025  5.0  0.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="now-update-a-in-2021-to-2023-to-a-new-value">
<h3><span class="section-number">6.5.2. </span>now update A in 2021 to 2023 to a new value,<a class="headerlink" href="#now-update-a-in-2021-to-2023-to-a-new-value" title="Permalink to this headline">#</a></h3>
<p>and watch how values after 2023 are updated, so the gowth rate after the update is unchanged</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;2021 2025&gt;  a =growth 1 2 3 4 5 </span>
<span class="s1">&lt;2021 2023&gt;  a = 120  --kg</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span><span class="n">lprint</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataframe:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataframe:
           A      B
2020  100.00  100.0
2021  120.00  100.0
2022  120.00  100.0
2023  120.00  100.0
2024  124.80  100.0
2025  131.04  100.0

Growth:
         A    B
2020   NaN  NaN
2021  20.0  0.0
2022   0.0  0.0
2023   0.0  0.0
2024   4.0  0.0
2025   5.0  0.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="a-more-advanced-example">
<h3><span class="section-number">6.5.3. </span>A more advanced example<a class="headerlink" href="#a-more-advanced-example" title="Permalink to this headline">#</a></h3>
<p>Where more advanced python is used</p>
<section id="first-create-a-string-with-update-lines">
<h4><span class="section-number">6.5.3.1. </span>First create a string with update lines<a class="headerlink" href="#first-create-a-string-with-update-lines" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lines</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>                               
 <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;&lt;2020     &gt; </span><span class="si">{</span><span class="n">varname</span><span class="si">}</span><span class="s1"> = 100 </span>
<span class="s1">      &lt;2021 2025&gt; </span><span class="si">{</span><span class="n">varname</span><span class="si">}</span><span class="s1"> =growth 1 2 3 4 5&#39;&#39;&#39;</span>
     <span class="k">for</span> <span class="n">varname</span> <span class="ow">in</span> <span class="s1">&#39;c d e f&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;2020     &gt; c = 100 
      &lt;2021 2025&gt; c =growth 1 2 3 4 5
&lt;2020     &gt; d = 100 
      &lt;2021 2025&gt; d =growth 1 2 3 4 5
&lt;2020     &gt; e = 100 
      &lt;2021 2025&gt; e =growth 1 2 3 4 5
&lt;2020     &gt; f = 100 
      &lt;2021 2025&gt; f =growth 1 2 3 4 5
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em><strong>Python constructs</strong></em></p>
<p>The creation of update lines involves a number of useful python constructs. A short
description:<br></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Python construct</p></th>
<th class="text-align:left head"><p>explanation</p></th>
<th class="text-align:left head"><p>Google</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>‘a b’.split()</p></td>
<td class="text-align:left"><p>splits a string by <code class="docutils literal notranslate"><span class="pre">blanks</span></code>into a list</p></td>
<td class="text-align:left"><p><a class="reference external" href="https://www.google.com/search?q=python+split&amp;newwindow=1">Search</a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>‘\n’.join()</p></td>
<td class="text-align:left"><p>Creates a string from a list of string separated by \n (linebreak)</p></td>
<td class="text-align:left"><p><a class="reference external" href="https://www.google.com/search?q=python+string+join&amp;newwindow=1">Search</a></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>f’{varname} = ….’</p></td>
<td class="text-align:left"><p>A f-string, {varname} is replaced by the value of varname</p></td>
<td class="text-align:left"><p><a class="reference external" href="https://www.google.com/search?q=python+f-string&amp;newwindow=1">Search</a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>[varname for varname in a_list]</p></td>
<td class="text-align:left"><p>List comprehension which creates an implicit loop</p></td>
<td class="text-align:left"><p><a class="reference external" href="https://www.google.com/search?q=python+list+comprehension&amp;newwindow=1">Search</a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="use-the-update-lines-to-update-a-dataframe">
<h4><span class="section-number">6.5.3.2. </span>Use the update lines to update a dataframe<a class="headerlink" href="#use-the-update-lines-to-update-a-dataframe" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfnew</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
<span class="n">dfnew</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100.0</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>100</td>
      <td>100.0</td>
      <td>101.000000</td>
      <td>101.000000</td>
      <td>101.000000</td>
      <td>101.000000</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>100</td>
      <td>100.0</td>
      <td>103.020000</td>
      <td>103.020000</td>
      <td>103.020000</td>
      <td>103.020000</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>100.0</td>
      <td>106.110600</td>
      <td>106.110600</td>
      <td>106.110600</td>
      <td>106.110600</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100.0</td>
      <td>110.355024</td>
      <td>110.355024</td>
      <td>110.355024</td>
      <td>110.355024</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100.0</td>
      <td>115.872775</td>
      <td>115.872775</td>
      <td>115.872775</td>
      <td>115.872775</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="update-the-new-dataframe-and-keep-some-of-the-growth-rates">
<h4><span class="section-number">6.5.3.3. </span>Update the new dataframe and keep some of the growth rates<a class="headerlink" href="#update-the-new-dataframe-and-keep-some-of-the-growth-rates" title="Permalink to this headline">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">keep_growth=True</span></code> now all lines as default keep the growth rate</p>
<ul class="simple">
<li><p>c,d are updated in 2022 and 2023 and keep the growth rates afterwards</p></li>
<li><p>e the –no_keep_growth in this line prevents the updating 2024-2025</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfres</span> <span class="o">=</span> <span class="n">dfnew</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;2022 2023&gt; c = 200 </span>
<span class="s1">&lt;2022 2023&gt; d = 300  </span>
<span class="s1">&lt;2022 2023&gt; e = 400  --no_keep_growth</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span><span class="n">keep_growth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataframe:</span><span class="se">\n</span><span class="si">{</span><span class="n">dfres</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">dfres</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataframe:
        A      B      C      D           E           F
2020  100  100.0  100.0  100.0  100.000000  100.000000
2021  100  100.0  101.0  101.0  101.000000  101.000000
2022  100  100.0  200.0  300.0  400.000000  103.020000
2023  100  100.0  200.0  300.0  400.000000  106.110600
2024  100  100.0  208.0  312.0  110.355024  110.355024
2025  100  100.0  218.4  327.6  115.872775  115.872775

Growth:
        A    B          C           D           E    F
2020  NaN  NaN        NaN         NaN         NaN  NaN
2021  0.0  0.0   1.000000    1.000000    1.000000  1.0
2022  0.0  0.0  98.019802  197.029703  296.039604  2.0
2023  0.0  0.0   0.000000    0.000000    0.000000  3.0
2024  0.0  0.0   4.000000    4.000000  -72.411244  4.0
2025  0.0  0.0   5.000000    5.000000    5.000000  5.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="kg-can-replace-keep-growth-and-nkg-can-replace-non-keep-growth">
<h3><span class="section-number">6.5.4. </span>–kg can replace –keep_growth and –nkg can replace –non_keep_growth<a class="headerlink" href="#kg-can-replace-keep-growth-and-nkg-can-replace-non-keep-growth" title="Permalink to this headline">#</a></h3>
<p>Just to make typing more easy</p>
</section>
</section>
<section id="update-several-variable-in-one-line">
<h2><span class="section-number">6.6. </span>Update several variable in one line<a class="headerlink" href="#update-several-variable-in-one-line" title="Permalink to this headline">#</a></h2>
<p>Sometime there is a need to update several variable with the same value over the same time frame. To ease this case .update can accept several variables in one line</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;2022 2024&gt; h i j k =      40 </span>
<span class="s1">&lt;2020&gt;      p q r s =       1000</span>
<span class="s1">&lt;2021 -1&gt;   p q r s =growth 2     # -1 indicates the last year </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
      <th>K</th>
      <th>P</th>
      <th>Q</th>
      <th>R</th>
      <th>S</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>100</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1020.000000</td>
      <td>1020.000000</td>
      <td>1020.000000</td>
      <td>1020.000000</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>100</td>
      <td>100.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>1040.400000</td>
      <td>1040.400000</td>
      <td>1040.400000</td>
      <td>1040.400000</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>100.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>1061.208000</td>
      <td>1061.208000</td>
      <td>1061.208000</td>
      <td>1061.208000</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>1082.432160</td>
      <td>1082.432160</td>
      <td>1082.432160</td>
      <td>1082.432160</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1104.080803</td>
      <td>1104.080803</td>
      <td>1104.080803</td>
      <td>1104.080803</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="upd-scale-number-default-1-scale-the-updates">
<h2><span class="section-number">6.7. </span>.upd(,,scale=&lt;number, default=1&gt;) Scale the updates<a class="headerlink" href="#upd-scale-number-default-1-scale-the-updates" title="Permalink to this headline">#</a></h2>
<p>When creating scenarios consistent of several updates it can be useful to be able to create
a number of scenarios based on one update but with different scale. For instance scale=0 is the baseline while scale=0.5 is a scenario half
the severity.</p>
<p>In the example below the values of the dataframes are printed.<br>
In a more realistic example  the <code class="docutils literal notranslate"><span class="pre">print()</span></code> below  would be changed to a call to a model instance, so the model would be simulated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;input dataframe: </span><span class="se">\n</span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">severity</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span> 
    <span class="c1"># First make a dataframe with some growth rate </span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    &lt;2021 2025&gt;</span>
<span class="s1">    a =growth 1 2 3 4 5 </span>
<span class="s1">    b + 10</span>
<span class="s1">    &#39;&#39;&#39;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">severity</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">severity</span><span class="si">=}</span><span class="se">\n</span><span class="s1">Dataframe:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1">#  </span>
    <span class="c1"># Here the updated dataframe is only printet. </span>
    <span class="c1"># A more realistic use case is to simulate a model like this: </span>
    <span class="c1"># dummy_ = mpak(res,keep=&#39;Severity {serverity}&#39;)    # more realistic </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input dataframe: 
        A      B
2020  100  100.0
2021  100  100.0
2022  100  100.0
2023  100  100.0
2024  100  100.0
2025  100  100.0


severity=0
Dataframe:
        A      B
2020  100  100.0
2021  100  100.0
2022  100  100.0
2023  100  100.0
2024  100  100.0
2025  100  100.0

Growth:
        A    B
2020  NaN  NaN
2021  0.0  0.0
2022  0.0  0.0
2023  0.0  0.0
2024  0.0  0.0
2025  0.0  0.0


severity=0.5
Dataframe:
               A      B
2020  100.000000  100.0
2021  100.500000  105.0
2022  101.505000  105.0
2023  103.027575  105.0
2024  105.088126  105.0
2025  107.715330  105.0

Growth:
        A    B
2020  NaN  NaN
2021  0.5  5.0
2022  1.0  0.0
2023  1.5  0.0
2024  2.0  0.0
2025  2.5  0.0


severity=1
Dataframe:
               A      B
2020  100.000000  100.0
2021  101.000000  110.0
2022  103.020000  110.0
2023  106.110600  110.0
2024  110.355024  110.0
2025  115.872775  110.0

Growth:
        A     B
2020  NaN   NaN
2021  1.0  10.0
2022  2.0   0.0
2023  3.0   0.0
2024  4.0   0.0
2025  5.0   0.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="upd-lprint-true-prints-vaues-the-before-and-after-update">
<h2><span class="section-number">6.8. </span>.upd(,,lprint=True ) prints vaues the before and after update<a class="headerlink" href="#upd-lprint-true-prints-vaues-the-before-and-after-update" title="Permalink to this headline">#</a></h2>
<p>When creating scenarios consistent of several updates it can be useful to be able to create
a number of scenarios based on one update but with different scale. For instance scale=0 is the baseline wile scale=0.5 is a scenario half
the severity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Same number of values as years</span>
<span class="s1">&lt;2021 2022&gt; A *  42 44</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span><span class="n">lprint</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Update * [42.0, 44.0] 2021 2022
A                    Before                After                 Diff
2021               100.0000            4200.0000            4100.0000
2022               100.0000            4400.0000            4300.0000
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>4200</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>4400</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="upd-create-true-requires-the-variable-to-exist">
<h2><span class="section-number">6.9. </span>.upd(,,create=True ) Requires the variable to exist<a class="headerlink" href="#upd-create-true-requires-the-variable-to-exist" title="Permalink to this headline">#</a></h2>
<p>Until now .upd has created variables if they did not exist in the input dataframe.</p>
<p>To catch misspellings the parameter <code class="docutils literal notranslate"><span class="pre">create</span></code> can be set to False.
New variables will not be created, and an exception will be raised.</p>
<p>Here Pythons exception handling is uses, so the notebook will continue to run the cells below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    # Same number of values as years</span>
<span class="s1">    &lt;2021 2022&gt; Aa *  42 44</span>
<span class="s1">    &#39;&#39;&#39;</span><span class="p">,</span><span class="n">create</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">inst</span><span class="p">:</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variable to update not found:AA, timespan = [2021 2022] 
Set create=True if you want the variable created: 
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-call">
<h2><span class="section-number">6.10. </span>The call<a class="headerlink" href="#the-call" title="Permalink to this headline">#</a></h2>
<p>def update(indf, updates, lprint=False,scale = 1.0,create=True,keep_growth=False,start=’’,end=’’)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Args:
        indf (DataFrame): input dataframe.
        basis (string): lines with variable updates look below.
        lprint (bool, optional): if True each update is printed  Defaults to False.
        scale (float, optional): A multiplier used on all update input . Defaults to 1.0.
        create (bool, optional): Creates a variables if not in the dataframe . Defaults to True.
        keep_growth(bool, optional): Keep the growth rate after the update time frame. Defaults to False.

    Returns:
        df (TYPE): the updated dataframe .
        
    A line in updates looks like this:     
           
    &quot;&lt;&quot;[[start] end]&quot;&gt;&quot; &lt;var....&gt; &lt;=|+|*|%|=growth|+growth|=diff&gt; &lt;value&gt;...  [--keep_growth_rate|--no_keep_growth_rate]
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content\howto\update"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../../notebooks/pandas/dataframes.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">5. </span>Introduction to Pandas dataframes</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="extending_dataframes.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Extend Pandas dataframes with ModelFLow capabilities.</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Ib Hansen<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>