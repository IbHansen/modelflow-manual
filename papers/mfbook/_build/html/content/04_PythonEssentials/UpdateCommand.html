

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4. Modelflow extensions to pandas &#8212; The World Bank&#39;s MFMod Framework in Python with Modelflow</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/04_PythonEssentials/UpdateCommand';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.2. .mfcalc() an extension of standard Pandas" href="mfcalc.html" />
    <link rel="prev" title="2. Some Python basics" href="PythonPandasDataframes.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../introduction.html">
  
  
  
  
  
    <p class="title logo__title">The World Bank's MFMod Framework in Python with Modelflow</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../introduction.html">
                    Foreword
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">The World Bank's MFMod Framework and Modelflow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01_Introduction/Introduction.html">1. Introduction</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../02_MacrostructuralModels/MacroStructuralModels.html">1.4. Macrostructural models</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../02_MacrostructuralModels/MFModAndModelFlow.html">2. Modelflow and the MFMod models of the World Bank</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_Installation/InstallingPython.html">2.1. Installation of Modelflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_Installation/InstallingModelFlow.html">2.2. Installation of Modelflow</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Some python essentials for using WorldBank models with modelflow</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Intro_Jupyter_notebook.html">1. Introduction to  Jupyter Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="PythonPandasDataframes.html">2. Some Python basics</a></li>

<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">4. Modelflow extensions to pandas</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mfcalc.html">4.2. <code class="docutils literal notranslate"><span class="pre">.mfcalc()</span></code> an extension of standard Pandas</a></li>

</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Using modelflow with World Bank models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../06_WBModels/LoadingWBModel.html">1. Using <code class="docutils literal notranslate"><span class="pre">modelflow</span></code> with World Bank models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_WBModels/ScenarioAnalysis.html">2. Scenario analysis</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/IbHansen/modelflow-manual/blob/AndrewEdits/papers/mfbook/content/04_PythonEssentials/UpdateCommand.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/IbHansen/modelflow-manual" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/04_PythonEssentials/UpdateCommand.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelflow extensions to pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-method-of-modelflow">4.1. .upd() method of modelflow</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-method-operators">4.1.1. <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> method operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-some-examples">4.1.2. <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> some examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-python-environment">4.1.3. Setting up the python environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-upd-to-create-a-new-variable-operator">4.1.4. Use .upd to create a new variable (= operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-updates-and-specific-time-periods">4.1.5. Multiple updates and specific time periods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-specific-datapoints-to-specific-values">4.1.6. Setting specific datapoints to specific values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-the-specified-values-to-all-values-in-a-range-the-operator">4.1.7. Adding  the specified  values to all values in a range (the + operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplying-all-values-in-a-range-by-the-specified-values-the-operator">4.1.8. Multiplying all values in a range by the specified values (the * operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#increasing-all-values-in-a-range-by-a-specified-percent-amount-the-operator">4.1.9. Increasing all  values in a range by a  specified percent amount (the % operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-percent-growth-rate-to-specified-values-growth">4.1.10. Set the percent growth rate to specified values (=GROWTH)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-or-subtract-from-the-existing-percent-growth-rate-growth-operator">4.1.11. Add or subtract from the existing percent growth rate (+GROWTH operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-change-in-a-variable-to-specific-values-diff-operator">4.1.12. Set the change in a variable to specific values (=diff operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recall-that-we-have-not-overwritten-df-so-the-df-dataframe-is-unchanged">4.1.13. Recall  that we have not overwritten df, so the df dataframe is unchanged.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#keep-growth-rates-after-the-update-time-the-kg-option">4.1.14. Keep growth rates after the update time – the –kg option</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-default-keep-growth-behaviour">4.1.14.1. The default keep_growth behaviour</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-keep-growth-some-more-examples">4.1.15. .upd(,,,keep_growth) some more examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-a-new-dataframe-first-make-a-dataframe-with-some-growth-rate">4.1.16. Initialize a new dataframe First make a dataframe with some growth rate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#now-update-a-in-2021-to-2023-to-a-new-value">4.1.17. now update A in 2021 to 2023 to a new value</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-with-the-option-keep-growth-set-globally">4.1.17.1. .upd() with the option keep_growth set globally</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-several-variable-in-one-line">4.1.18. Update several variable in one line</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-scale-number-default-1-scale-the-updates">4.1.19. .upd(,,scale=&lt;number, default=1&gt;) Scale the updates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-lprint-true-prints-values-the-before-and-after-update">4.1.20. .upd(,,lprint=True ) prints values the before and after update</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-create-true-requires-the-variable-to-exist">4.1.21. .upd(,,create=True ) Requires the variable to exist</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelflow-extensions-to-pandas">
<h1><span class="section-number">4. </span>Modelflow extensions to pandas<a class="headerlink" href="#modelflow-extensions-to-pandas" title="Permalink to this headline">#</a></h1>
<p>Modeflow inherits all the capabilities of pandas and extends some as well.</p>
<p>Data in a dataframe can be modified directly with built-in pandas functionalities like <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code>, but <code class="docutils literal notranslate"><span class="pre">modelflow</span></code> extends these capabilities with in important ways with the <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> and <code class="docutils literal notranslate"><span class="pre">.mfcalc()</span></code> methods.</p>
<section id="upd-method-of-modelflow">
<h2><span class="section-number">4.1. </span>.upd() method of modelflow<a class="headerlink" href="#upd-method-of-modelflow" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> method extends pandas by giving the user a concise and expressive way to modify data in a dataframe using a syntax that a database-manager or macroeconomic modeler might find more natural.</p>
<p>Notably it allows the user to employ formula’s to do updates, and supports both lags and leads on variables.</p>
<p><code class="docutils literal notranslate"><span class="pre">.upd()</span></code> can be used to:</p>
<ul class="simple">
<li><p>Perform different types of  updates</p></li>
<li><p>Perform multiple updates each on a new line</p></li>
<li><p>Perform changes over specific periods</p></li>
<li><p>Use one input which is used for all time frames, or a separate input for each time</p></li>
<li><p>Preserve pre-shock growth rates for out of sample time-periods</p></li>
<li><p>Display results</p></li>
</ul>
<section id="upd-method-operators">
<h3><span class="section-number">4.1.1. </span><code class="docutils literal notranslate"><span class="pre">.upd()</span></code> method operators<a class="headerlink" href="#upd-method-operators" title="Permalink to this headline">#</a></h3>
<p>Below are some of the operators that can be used in the <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> method</p>
<p><strong>Types of update:</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-left head"><p>Update to perform</p></th>
<th class="text-left head"><p>Use this operator</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Set a variable equal to the input</p></td>
<td class="text-left"><p>=</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Add the input to the input</p></td>
<td class="text-left"><p>+</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Set the variable to itself multiplied by the input</p></td>
<td class="text-left"><p>*</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Increase/Decrease the variable by a percent of itself (1+input/100)</p></td>
<td class="text-left"><p>%</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Set the growth rate of the variable to the input</p></td>
<td class="text-left"><p>=growth</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Change the growth rate of the variable to its current growth rate plus the input value in percentage points</p></td>
<td class="text-left"><p>+growth</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Specify the amount by which the variable should increase from its previous period level (<span class="math notranslate nohighlight">\(\Delta = var_t - var_{t-1}\)</span>)</p></td>
<td class="text-left"><p>=diff</p></td>
</tr>
</tbody>
</table>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Note: the syntax of an update command requires that there be a space between variable names and the operators.</p>
<p>Thus <code class="docutils literal notranslate"><span class="pre">df.upd(&quot;A</span> <span class="pre">=</span> <span class="pre">7&quot;)</span></code> is fine, but <code class="docutils literal notranslate"><span class="pre">df.upd(&quot;A</span> <span class="pre">=7&quot;)</span></code> will generate an error.</p>
<p>Similarly  <code class="docutils literal notranslate"><span class="pre">df.upd(&quot;A</span> <span class="pre">*</span> <span class="pre">1.1&quot;)</span></code> is fine, but <code class="docutils literal notranslate"><span class="pre">df.upd(&quot;A*</span> <span class="pre">1.1&quot;)</span></code> will generate an error.</p>
</div>
</section>
<section id="upd-some-examples">
<h3><span class="section-number">4.1.2. </span><code class="docutils literal notranslate"><span class="pre">.upd()</span></code> some examples<a class="headerlink" href="#upd-some-examples" title="Permalink to this headline">#</a></h3>
</section>
<section id="setting-up-the-python-environment">
<h3><span class="section-number">4.1.3. </span>Setting up the python environment<a class="headerlink" href="#setting-up-the-python-environment" title="Permalink to this headline">#</a></h3>
<p>In order to use <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> all of the necessary libraries must be <strong>imported</strong> into the python session.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="c1"># First import pandas and the model into the  workspace</span>
<span class="c1"># There is no problem importing multiple times, though it is not very efficient.</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">modelclass</span> <span class="kn">import</span> <span class="n">model</span> 
<span class="c1"># functions that improve rendering of modelflow outputs under Jupyter Notebook</span>
<span class="n">model</span><span class="o">.</span><span class="n">widescreen</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">scroll_off</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <style>
            div#notebook-container    { width: 95%; }
            div#menubar-container     { width: 65%; }
            div#maintoolbar-container { width: 99%; }
        </style>
        </div></div>
</div>
<p>Now create a dataframe using standard pandas syntax.  In this instance with years as the index and a dictionary defining the variables and their data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a dataframe using standard pandas</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="s1">&#39;E&#39;</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]},</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2018</span><span class="p">,</span><span class="mi">2019</span><span class="p">,</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2021</span><span class="p">])</span>
<span class="n">df</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>1</td>
      <td>6</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A somewhat more creative way to initialize the dataframe for dates would use a loop to specify the dates that get passed to the constructor as an argument.</p>
<p>Below a dataframe df with two Series (A and B), is initialized with the values 100 for all data points.</p>
<p>The index is defined dynamically by a loop <code class="docutils literal notranslate"><span class="pre">index=[2020+v</span> <span class="pre">for</span> <span class="pre">v</span> <span class="pre">in</span> <span class="pre">range(number_of_rows)]</span></code> that runs for number_of_rows times (6 times in this example) setting v equal to 2020+0, 2020+1,…,202+5. The resulting list whose values are assigned to index is [2020,2021,2022,2023,2024,2025].</p>
<p>The big advantage of this method is that if the user wanted to have data created for the period 1990 to 2030, they would only have to change number_of_rows from 6 to 41 and 2020 in the loop to 1990.</p>
<p>The second example simplifies further by just specifying the begin and end point of the range.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define the number of years for which the data is to be created.</span>
<span class="n">number_of_rows</span> <span class="o">=</span> <span class="mi">6</span> 

<span class="c1"># call the dataframe constructor</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span>
       <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2020</span><span class="o">+</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_rows</span><span class="p">)],</span> <span class="c1"># create row index</span>
       <span class="c1"># equivalent to index=[2020,2021,2022,2023,2024,2025] </span>
       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>                                 <span class="c1"># create column name </span>
<span class="n">df</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span>
       <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2030</span><span class="p">)],</span> <span class="c1"># create row index</span>
       <span class="c1"># equivalent to index=[2020,2021,...,2030] </span>
       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="s1">&#39;B1&#39;</span><span class="p">])</span>                                 <span class="c1"># create column name </span>
<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A1</th>
      <th>B1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>200</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>200</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>200</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>200</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>200</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>200</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2026</th>
      <td>200</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2027</th>
      <td>200</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2028</th>
      <td>200</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2029</th>
      <td>200</td>
      <td>200</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="use-upd-to-create-a-new-variable-operator">
<h3><span class="section-number">4.1.4. </span>Use .upd to create a new variable (= operator)<a class="headerlink" href="#use-upd-to-create-a-new-variable-operator" title="Permalink to this headline">#</a></h3>
<p>With standard pandas a user can add a column (series) to a dataframe simply by assigning a adding to a dataframe.  For example:</p>
<p><code class="docutils literal notranslate"><span class="pre">df['NEW2']=[17,12,14,15]</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">.upd()</span></code> provides this functionality as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;c = 142&#39;</span><span class="p">)</span> 
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>100</td>
      <td>100</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>100</td>
      <td>100</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>100</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100</td>
      <td>142.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the new variable name was entered as a lower case ‘c’ here.  Lowercase letters are not legal <code class="docutils literal notranslate"><span class="pre">modelflow</span></code> variable names.  The <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> method knows is part of modelflow and knows this rule, so it automatically translates lowercase entries into upper case so that the statement works.</p>
</div>
</section>
<section id="multiple-updates-and-specific-time-periods">
<h3><span class="section-number">4.1.5. </span>Multiple updates and specific time periods<a class="headerlink" href="#multiple-updates-and-specific-time-periods" title="Permalink to this headline">#</a></h3>
<p>The modelflow method <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> takes a string as an argument.  That string can contain a single update command or can contain multiple commands.</p>
<p>Moreover by including a &lt;Begin End&gt; date clause in a given update command, the update will be restricted to the associated time period.</p>
<p>The below illustrates this, modifying two existing variables A, B over different time periods and creating a new variable.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Note that the third line inherits the time period of the previous line.</p>
<p>Note also the submitted string can include comments as well (denoted with the standard python # indicator).</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Same number of values as years</span>
<span class="s2">&lt;2021 2024&gt; A = 42 44 45 46    # 4 years</span>
<span class="s2">&lt;2020     &gt; B = 200            # 1 year </span>
<span class="s2">c = 500                        # Same period as previous line</span>
<span class="s2">&lt;-0 -1&gt; D = 33                   # All years </span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>200</td>
      <td>500.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>42</td>
      <td>100</td>
      <td>0.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>44</td>
      <td>100</td>
      <td>0.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>45</td>
      <td>100</td>
      <td>0.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>46</td>
      <td>100</td>
      <td>0.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100</td>
      <td>0.0</td>
      <td>33.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>Time scope of .upd()</strong></p>
<p>Made this a margin just to see</p>
<p>The update command takes a variety of mathematical operators <code class="docutils literal notranslate"><span class="pre">=,</span> <span class="pre">+,</span> <span class="pre">*,</span> <span class="pre">%</span> <span class="pre">=GROWTH,</span> <span class="pre">+GROWTH,</span> <span class="pre">=DIFF</span></code> and applies them to data for the period set in the leading &lt;&gt;.</p>
<p>If the user wants to modify a series or group of series for only a specific point in time or a period of time, she can indicate the period in the command line.</p>
<ul class="simple">
<li><p>If <strong>one date</strong> is specified the operation is applied to a single point in time</p></li>
<li><p>If <strong>two dates</strong>  are specifies the operation is applied over a period of time.</p></li>
</ul>
<p>The selected time period will persist until re-set with a new time specification. Useful to avoid visual noise if several variables are going to be updated for the same time period.</p>
<p>The time period can be rest to the full time-period by using the special &lt;-0 -1&gt; time period.  More generally:</p>
<ul class="simple">
<li><p>Indicates the start of the dataframe use -0</p></li>
<li><p>Indicates the end of the dataframe use -1</p></li>
</ul>
<p>If no time is provided the dataframe start and end period will be used.</p>
</aside>
</section>
<section id="setting-specific-datapoints-to-specific-values">
<h3><span class="section-number">4.1.6. </span>Setting specific datapoints to specific values<a class="headerlink" href="#setting-specific-datapoints-to-specific-values" title="Permalink to this headline">#</a></h3>
<p>This example, demonstrates the equals operator.  The <code class="docutils literal notranslate"><span class="pre">=</span></code> operator indicates that the variable a should be set equal to the indicated values following the <code class="docutils literal notranslate"><span class="pre">=</span></code> operator (42 44 45 46 in the first line, 200 in the second and 500 inthe third). The dates enclosed in &lt;&gt; indicate the period over which the change should be applied.</p>
<p>Either:</p>
<ul class="simple">
<li><p>The number of data points provided must match the number of dates in the period, Or</p></li>
<li><p>Only one data point is provided, it is applied to all dates in the period.</p></li>
</ul>
<p>If only one period is to be modified then it can be followed by just one date.</p>
<p>Note that the final line inherited the time period set in the second line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Same number of values as years</span>
<span class="s2">&lt;2021 2024&gt; A = 42 44 45 46    # 4 years</span>
<span class="s2">&lt;2023     &gt; B = 200            # 1 year </span>
<span class="s2">c = 500</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>42</td>
      <td>100</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>44</td>
      <td>100</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>45</td>
      <td>200</td>
      <td>500.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>46</td>
      <td>100</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="adding-the-specified-values-to-all-values-in-a-range-the-operator">
<h3><span class="section-number">4.1.7. </span>Adding  the specified  values to all values in a range (the + operator)<a class="headerlink" href="#adding-the-specified-values-to-all-values-in-a-range-the-operator" title="Permalink to this headline">#</a></h3>
<p>NB: Here upd with the  + operator indicates that we are adding 42.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Or one number to all years in between start and end </span>
<span class="s1">&lt;2022 2024&gt; B  +  42    # one value broadcast to 3 years </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>100</td>
      <td>142</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>142</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>142</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="multiplying-all-values-in-a-range-by-the-specified-values-the-operator">
<h3><span class="section-number">4.1.8. </span>Multiplying all values in a range by the specified values (the * operator)<a class="headerlink" href="#multiplying-all-values-in-a-range-by-the-specified-values-the-operator" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Same number of values as years</span>
<span class="s1">&lt;2021 2023&gt; A *  42 44 55</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>4200</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>4400</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>5500</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="increasing-all-values-in-a-range-by-a-specified-percent-amount-the-operator">
<h3><span class="section-number">4.1.9. </span>Increasing all  values in a range by a  specified percent amount (the % operator)<a class="headerlink" href="#increasing-all-values-in-a-range-by-a-specified-percent-amount-the-operator" title="Permalink to this headline">#</a></h3>
<p>In this example:</p>
<ul class="simple">
<li><p>A is increased by 42 and 44% over the range 2021 through 2022.</p></li>
<li><p>B is increased by 10 percent in all years</p></li>
<li><p>C is a new variable, is created and set to 100 for the whole range</p></li>
<li><p>C is decreased by 12 percent over the range 2023 through 2025.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;2021 2022 &gt; A %  42 44   </span>
<span class="s1">&lt;-0 -1&gt; B % 10            # all rows </span>
<span class="s1">C = 100                   # all rows persist </span>
<span class="s1">&lt;2023 2025&gt; C % -12       # now only for 3 years </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>110.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>142</td>
      <td>110.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>144</td>
      <td>110.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>110.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>110.0</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>110.0</td>
      <td>88.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="set-the-percent-growth-rate-to-specified-values-growth">
<h3><span class="section-number">4.1.10. </span>Set the percent growth rate to specified values (=GROWTH)<a class="headerlink" href="#set-the-percent-growth-rate-to-specified-values-growth" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Same number of values as years</span>
<span class="s1">&lt;2021 2022&gt; A =GROWTH  1 5  </span>
<span class="s1">&lt;2020&gt; c = 100 </span>
<span class="s1">&lt;2021 2025&gt; c =GROWTH 2 </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataframe:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># Explained b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataframe:
           A    B           C
2020  100.00  100  100.000000
2021  101.00  100  102.000000
2022  106.05  100  104.040000
2023  100.00  100  106.120800
2024  100.00  100  108.243216
2025  100.00  100  110.408080

Growth:
             A    B    C
2020       NaN  NaN  NaN
2021  1.000000  0.0  2.0
2022  5.000000  0.0  2.0
2023 -5.704856  0.0  2.0
2024  0.000000  0.0  2.0
2025  0.000000  0.0  2.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-or-subtract-from-the-existing-percent-growth-rate-growth-operator">
<h3><span class="section-number">4.1.11. </span>Add or subtract from the existing percent growth rate (+GROWTH operator)<a class="headerlink" href="#add-or-subtract-from-the-existing-percent-growth-rate-growth-operator" title="Permalink to this headline">#</a></h3>
<p>The below example is a bit more complicated.</p>
<p>The first line sets the growth rate of A to 1% in all periods beginning in  2021</p>
<p>The second command adds 2 3 4 5 6 to the growth rates in each period after 2021, resulting in growth rates of 3,4,5,6,7.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;2021 &gt; A =GROWTH  1  # All selected years set to the same growth rate</span>
<span class="s1">a +growth   2  # Add to the existing growth rate these numbers  </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataframe:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataframe:
        A    B
2020  100  100
2021  103  100
2022  100  100
2023  100  100
2024  100  100
2025  100  100

Growth:
             A    B
2020       NaN  NaN
2021  3.000000  0.0
2022 -2.912621  0.0
2023  0.000000  0.0
2024  0.000000  0.0
2025  0.000000  0.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-the-change-in-a-variable-to-specific-values-diff-operator">
<h3><span class="section-number">4.1.12. </span>Set the change in a variable to specific values (=diff operator)<a class="headerlink" href="#set-the-change-in-a-variable-to-specific-values-diff-operator" title="Permalink to this headline">#</a></h3>
<p><span class="math notranslate nohighlight">\(\Delta = var_t - var_{t-1} = some number\)</span></p>
<p>Here sets the value of A in 2021 to 2 more than the value of 2020, and the 2022 value as 4 more than the <strong>revised</strong> value of 2021.</p>
<p>The second line creates a new variable “UPBY2” to the data frame and sets it equal to 100 for all periods,</p>
<p>The third line adds 2 to the previous periods value UPBY2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt; 2021 2022&gt; A =diff  2 4   # Same number of values as years</span>
<span class="s1">&lt;2020 &gt; UpBy2 = 100 # sets rows equal to the same  number for all years in between start and end </span>
<span class="s1">&lt;2021 2025&gt; UpBy2 =diff  2  </span>

<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>UPBY2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>102</td>
      <td>100</td>
      <td>102.0</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>106</td>
      <td>100</td>
      <td>104.0</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>100</td>
      <td>106.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100</td>
      <td>110.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="recall-that-we-have-not-overwritten-df-so-the-df-dataframe-is-unchanged">
<h3><span class="section-number">4.1.13. </span>Recall  that we have not overwritten df, so the df dataframe is unchanged.<a class="headerlink" href="#recall-that-we-have-not-overwritten-df-so-the-df-dataframe-is-unchanged" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>100</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>100</td>
      <td>100</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> only operates on on variable.  A command like <code class="docutils literal notranslate"><span class="pre">.upd('A</span> <span class="pre">=</span> <span class="pre">B')</span></code> would not work. For these kind of functions, use <code class="docutils literal notranslate"><span class="pre">.mfcalc()</span></code> (see next section).</p>
</div>
</section>
<section id="keep-growth-rates-after-the-update-time-the-kg-option">
<h3><span class="section-number">4.1.14. </span>Keep growth rates after the update time – the –kg option<a class="headerlink" href="#keep-growth-rates-after-the-update-time-the-kg-option" title="Permalink to this headline">#</a></h3>
<p>In a long projection it can sometime be useful to be able to update variables for which new information is available, but for the subsequent periods keep the growth rate the same as before the update. In database management this is frequently done when two time-series with different levels are spliced together.</p>
<p>The -kg or –keep_growth option instructs modelview to calculate the growth rate of the existing pre-change series, and then use it to preserve the pre-change growth rates of the series for the periods that were <strong>not</strong> changed.</p>
<p>This allows to update variables for which new information is available, but keep the growth rate the same as before the update in the period after the update time.</p>
<section id="the-default-keep-growth-behaviour">
<h4><span class="section-number">4.1.14.1. </span>The default keep_growth behaviour<a class="headerlink" href="#the-default-keep-growth-behaviour" title="Permalink to this headline">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">upd()</span></code> method has a parameter <code class="docutils literal notranslate"><span class="pre">keep_growth</span></code>, which by default is equal to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">keep_growth</span></code> determines how data in  the time periods after those where an update is executed are treated.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">keep_growth</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> then data in the sub-period after a change is left unchanged.</p>
<p>if <code class="docutils literal notranslate"><span class="pre">keep_growth</span></code> is set to “<code class="docutils literal notranslate"><span class="pre">True</span></code>” then the system will preserve the pre-change growth rate of the affected variable in the time period <em>after the change</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At the line level:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">keep_growth=True</span></code> can be expressed as –kg</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keep_growth=False</span></code> can be expressed as –nkg</p></li>
</ul>
</div>
<p>Let’s see this in a concrete example.  Consider the following <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> df with two variables A and B, that each grow by 2% per period, with A initialized at a level of 100 and B at a level of 110 so that we can see each separately on a graph.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span>
       <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2020</span><span class="o">+</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_rows</span><span class="p">)],</span> <span class="c1"># create row index</span>
       <span class="c1"># equivalent to index=[2020,2021,2022,2023,2024,2025] </span>
       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">])</span> 

<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;&lt;2021 -1&gt; A =growth 2</span>
<span class="s2">           &lt;2020 -1&gt;   B = 110</span>
<span class="s2">          &lt;2021 -1&gt;    B =growth 2</span>
<span class="s2">          &quot;&quot;&quot;</span><span class="p">)</span>
<span class="c1"># Store these variables for later use in comparisons</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;A_ORIG&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;B_ORIG&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>A_ORIG</th>
      <th>B_ORIG</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100.000000</td>
      <td>110.000000</td>
      <td>100.000000</td>
      <td>110.000000</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>102.000000</td>
      <td>112.200000</td>
      <td>102.000000</td>
      <td>112.200000</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>104.040000</td>
      <td>114.444000</td>
      <td>104.040000</td>
      <td>114.444000</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>106.120800</td>
      <td>116.732880</td>
      <td>106.120800</td>
      <td>116.732880</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>108.243216</td>
      <td>119.067538</td>
      <td>108.243216</td>
      <td>119.067538</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>110.408080</td>
      <td>121.448888</td>
      <td>110.408080</td>
      <td>121.448888</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../../_images/c02b4af773579f433eace4f785e543742d5ef841906e6b994877f90732f66fd1.png" src="../../_images/c02b4af773579f433eace4f785e543742d5ef841906e6b994877f90732f66fd1.png" />
</div>
</div>
<p>Now lets modify each by adding 5 to the level in 2022 and 2023.  For B we will do setting the keep_growth option as False and for ‘B’ keep_growth positive.  While the keep_growth is a global variable it can be set at the line level also using the –kg option (<code class="docutils literal notranslate"><span class="pre">keep_growth=True</span></code>) and –nkg option (<code class="docutils literal notranslate"><span class="pre">keep_growth=False</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;2022 2023&gt; A + 5 --kg</span>
<span class="s2">            &lt;2022 2023&gt; B + 5 --nkg</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;A_ORIG&#39;</span><span class="p">,</span><span class="s1">&#39;B_ORIG&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../../_images/b190fe24d2cb993f17006d33ba0fb9966a5860917c21cee0cbc7a3ba4322c9df.png" src="../../_images/b190fe24d2cb993f17006d33ba0fb9966a5860917c21cee0cbc7a3ba4322c9df.png" />
</div>
</div>
<p>In the first example ‘A’ (the green and blue lines) the level of A is increased by 5 for two periods (2021-2022). The subsequent values are also increased and they were calculated to maintain the growth rate of the original series.</p>
<p>For the ‘B’ variable the same level change was input but because of the <code class="docutils literal notranslate"><span class="pre">--nkg</span></code> (equivalent to <code class="docutils literal notranslate"><span class="pre">keep_growth=False</span></code>) the periods after the change were unaffected and retained their old values.</p>
<p>Below are plots the growth rates of the two transformed series.</p>
<p>Here the growth in both series accelerates in 2022, by slightly less than 5 percentage points because a) the base of each is more than 100, with the base of B being higher (it was initialized at 110). In 2023 the growth rate of A returns to 2 percent, while the growth rate of B is actually negative because the level (see earlier graph) has fallen back to its original level.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfg</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span>
<span class="n">dfg</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../../_images/93fc87a8e8ede996fa596d14d140f87c73411dfd2bd0aa8433f137f2597a0b85.png" src="../../_images/93fc87a8e8ede996fa596d14d140f87c73411dfd2bd0aa8433f137f2597a0b85.png" />
</div>
</div>
</section>
</section>
<section id="upd-keep-growth-some-more-examples">
<h3><span class="section-number">4.1.15. </span>.upd(,,,keep_growth) some more examples<a class="headerlink" href="#upd-keep-growth-some-more-examples" title="Permalink to this headline">#</a></h3>
</section>
<section id="initialize-a-new-dataframe-first-make-a-dataframe-with-some-growth-rate">
<h3><span class="section-number">4.1.16. </span>Initialize a new dataframe First make a dataframe with some growth rate<a class="headerlink" href="#initialize-a-new-dataframe-first-make-a-dataframe-with-some-growth-rate" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># instantiate a new dataframe with one column &#39;A&#39; with avlue 100 everywhere and index 2020-2025</span>
<span class="n">dftest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span>
       <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2020</span><span class="o">+</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_rows</span><span class="p">)],</span> <span class="c1"># create row index</span>
       <span class="c1"># equivalent to index=[2020,2021,2022,2023,2024,2025] </span>
       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>                                 <span class="c1"># create column name </span>

<span class="c1"># Update a to have growth rate accelerationg linearly by 1 from 1 oercent to 5 percent</span>
<span class="n">original</span> <span class="o">=</span> <span class="n">dftest</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&lt;2021 2025&gt; a =growth 1 2 3 4 5&#39;</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Levels:</span><span class="se">\n</span><span class="si">{</span><span class="n">original</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">original</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Levels:
               A
2020  100.000000
2021  101.000000
2022  103.020000
2023  106.110600
2024  110.355024
2025  115.872775

Growth:
        A
2020  NaN
2021  1.0
2022  2.0
2023  3.0
2024  4.0
2025  5.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="now-update-a-in-2021-to-2023-to-a-new-value">
<h3><span class="section-number">4.1.17. </span>now update A in 2021 to 2023 to a new value<a class="headerlink" href="#now-update-a-in-2021-to-2023-to-a-new-value" title="Permalink to this headline">#</a></h3>
<p>Below performs the same operation, the first time the updated value is assigned to the <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> <code class="docutils literal notranslate"><span class="pre">nkg</span></code> and the default behaviour of <code class="docutils literal notranslate"><span class="pre">keep_growth</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
<p>In the second example the <code class="docutils literal notranslate"><span class="pre">-kg</span></code> line option is specified, telling modelflow to maintain the growth rates of the dependent variable in the periods after the update is executed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nokg</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;2021 2025&gt;  a =growth 1 2 3 4 5 </span>
<span class="s1">&lt;2021 2023&gt;  a = 120  </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span><span class="n">lprint</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">kg</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;2021 2025&gt;  a =growth 1 2 3 4 5 </span>
<span class="s1">&lt;2021 2023&gt;  a = 120  --kg</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span><span class="n">lprint</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="n">kg</span><span class="o">=</span><span class="n">kg</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span><span class="s2">&quot;KG&quot;</span><span class="p">})</span>       <span class="c1">#rename cols to facilitate display</span>
<span class="n">nokg</span><span class="o">=</span><span class="n">nokg</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span><span class="s2">&quot;NOKG&quot;</span><span class="p">})</span> <span class="c1">#rename cols to facilitate display</span>

<span class="n">combo</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">kg</span><span class="p">,</span><span class="n">nokg</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">combo</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Levels</span><span class="se">\n</span><span class="si">{</span><span class="n">combo</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth</span><span class="se">\n</span><span class="si">{</span><span class="n">combo</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Levels
          KG        NOKG
2020  100.00  100.000000
2021  120.00  120.000000
2022  120.00  120.000000
2023  120.00  120.000000
2024  124.80  110.355024
2025  131.04  115.872775

Growth
        KG      NOKG
2020   NaN       NaN
2021  20.0  20.00000
2022   0.0   0.00000
2023   0.0   0.00000
2024   4.0  -8.03748
2025   5.0   5.00000
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the first example where KG (keep_growth) <strong>was not set</strong>, because the level was set constant for three periods at 120 the rate of growth was 0 for the final two years of the set period.  But following this update, the level of A in 2023 is 120. With <code class="docutils literal notranslate"><span class="pre">keep_Growth=False</span></code> (its default value)m the level of A in 2024 remains at its unchanged  unchanged (lower) level of 100.35. As a result, the growth rate in 2024 is negative.</p>
<p>In the <strong>–kg</strong> example, the pre-exsting growth rate (of 4%) is applied to the new value of 120 and so the level in 2024 is (120*1.04)=124.8 and 2025 is 131.04.</p>
</div>
<section id="upd-with-the-option-keep-growth-set-globally">
<h4><span class="section-number">4.1.17.1. </span>.upd() with the option keep_growth set globally<a class="headerlink" href="#upd-with-the-option-keep-growth-set-globally" title="Permalink to this headline">#</a></h4>
<p>Above the line level option <code class="docutils literal notranslate"><span class="pre">--keep_growth</span></code> or <code class="docutils literal notranslate"><span class="pre">--kg</span></code> was used to keep the growth rate(or not) for a given operation.</p>
<p>This works because by default the option <code class="docutils literal notranslate"><span class="pre">Keep_growth</span></code> is set to false, implementing <code class="docutils literal notranslate"><span class="pre">--kg</span></code> at the line level temporarily set the keep_growth flag to  true for the specific line (and those following).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">keep_growth</span></code> flag can also be set globally for all the lines by setting the option in the command line.</p>
<p><code class="docutils literal notranslate"><span class="pre">keep_growth=True</span></code>.</p>
<p>Now as default, all lines will keep the growth rate (unless overridden at the line level with <code class="docutils literal notranslate"><span class="pre">--nkg</span></code> or <code class="docutils literal notranslate"><span class="pre">--no_keep_growth</span></code>.</p>
<ul class="simple">
<li><p>c,d are updated in 2022 and 2023 and keep the growth rates afterwards</p></li>
<li><p>e the <code class="docutils literal notranslate"><span class="pre">--no_keep_growth</span></code> in this line prevents the updating 2024-2025</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a data frame</span>
<span class="n">dftest</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span>
       <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2020</span><span class="o">+</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_rows</span><span class="p">)],</span> <span class="c1"># create row index</span>
       <span class="c1"># equivalent to index=[2020,2021,2022,2023,2024,2025] </span>
       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">])</span>                                 <span class="c1"># create column name </span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>A_ORIG</th>
      <th>B_ORIG</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100.000000</td>
      <td>110.000000</td>
      <td>100.000000</td>
      <td>110.000000</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>102.000000</td>
      <td>112.200000</td>
      <td>102.000000</td>
      <td>112.200000</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>109.040000</td>
      <td>119.444000</td>
      <td>104.040000</td>
      <td>114.444000</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>111.120800</td>
      <td>121.732880</td>
      <td>106.120800</td>
      <td>116.732880</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>113.343216</td>
      <td>119.067538</td>
      <td>108.243216</td>
      <td>119.067538</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>115.610080</td>
      <td>121.448888</td>
      <td>110.408080</td>
      <td>121.448888</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfres</span> <span class="o">=</span> <span class="n">dftest</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;2022 2023&gt; c = 200 </span>
<span class="s1">&lt;2022 2023&gt; d = 300  </span>
<span class="s1">&lt;2022 2023&gt; e = 400  --no_keep_growth </span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span><span class="n">keep_growth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># &lt;=  Set keep_growth to True for the entirety of the command, </span>
                       <span class="c1"># except for e where it is overridden by the --no_keep_growth flag</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataframe:</span><span class="se">\n</span><span class="si">{</span><span class="n">dfres</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">dfres</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataframe:
        A    B      C      D    E
2020  100  100  100.0  100.0  100
2021  100  100  100.0  100.0  100
2022  100  100  200.0  300.0  400
2023  100  100  200.0  300.0  400
2024  100  100  200.0  300.0  100
2025  100  100  200.0  300.0  100

Growth:
        A    B      C      D      E
2020  NaN  NaN    NaN    NaN    NaN
2021  0.0  0.0    0.0    0.0    0.0
2022  0.0  0.0  100.0  200.0  300.0
2023  0.0  0.0    0.0    0.0    0.0
2024  0.0  0.0    0.0    0.0  -75.0
2025  0.0  0.0    0.0    0.0    0.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="update-several-variable-in-one-line">
<h3><span class="section-number">4.1.18. </span>Update several variable in one line<a class="headerlink" href="#update-several-variable-in-one-line" title="Permalink to this headline">#</a></h3>
<p>Sometime there is a need to update several variable with the same value over the same time frame. To ease this case .update can accept several variables in one line</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">&lt;2022 2024&gt; h i j k =      40      # earlier values are set to zero by default</span>
<span class="s1">&lt;2020&gt;      p q r s =       1000   # All values beginning in 2020 set to 1000</span>
<span class="s1">&lt;2021 -1&gt;   p q r s =growth 2      # -1 indicates the last year of dataframe</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>A_ORIG</th>
      <th>B_ORIG</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
      <th>K</th>
      <th>P</th>
      <th>Q</th>
      <th>R</th>
      <th>S</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100.000000</td>
      <td>110.000000</td>
      <td>100.000000</td>
      <td>110.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>102.000000</td>
      <td>112.200000</td>
      <td>102.000000</td>
      <td>112.200000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1020.000000</td>
      <td>1020.000000</td>
      <td>1020.000000</td>
      <td>1020.000000</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>109.040000</td>
      <td>119.444000</td>
      <td>104.040000</td>
      <td>114.444000</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>1040.400000</td>
      <td>1040.400000</td>
      <td>1040.400000</td>
      <td>1040.400000</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>111.120800</td>
      <td>121.732880</td>
      <td>106.120800</td>
      <td>116.732880</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>1061.208000</td>
      <td>1061.208000</td>
      <td>1061.208000</td>
      <td>1061.208000</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>113.343216</td>
      <td>119.067538</td>
      <td>108.243216</td>
      <td>119.067538</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>1082.432160</td>
      <td>1082.432160</td>
      <td>1082.432160</td>
      <td>1082.432160</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>115.610080</td>
      <td>121.448888</td>
      <td>110.408080</td>
      <td>121.448888</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1104.080803</td>
      <td>1104.080803</td>
      <td>1104.080803</td>
      <td>1104.080803</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="upd-scale-number-default-1-scale-the-updates">
<h3><span class="section-number">4.1.19. </span>.upd(,,scale=&lt;number, default=1&gt;) Scale the updates<a class="headerlink" href="#upd-scale-number-default-1-scale-the-updates" title="Permalink to this headline">#</a></h3>
<p>When running a scenario it can be useful to be able to create a number of scenarios based on one update but with different scale.</p>
<p>This can be particularly useful when we want to do sensitivity analyses of model results, depending on how heavily a shocked variable is hit</p>
<p>When using the scale option, scale=0  the baseline while scale=0.5 is a scenario half
the severity.</p>
<p>In the example below the values of the dataframes are printed. We use the scale option (setting to to 0, 0.5 and 1) to run three scenarios using the same code but where the update in each case is multiplied by either 0, 0.5 or 1.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here we are just printing the outputs, a more interesting example would involve the solving a  model using different levels of a given shock.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;input dataframe: </span><span class="se">\n</span><span class="si">{</span><span class="n">df</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">severity</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span> 
    <span class="c1"># First make a dataframe with some growth rate </span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    &lt;2021 2025&gt;</span>
<span class="s1">    a =growth 1 2 3 4 5 </span>
<span class="s1">    b + 10</span>
<span class="s1">    &#39;&#39;&#39;</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">severity</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">severity</span><span class="si">=}</span><span class="se">\n</span><span class="s1">Dataframe:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">Growth:</span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1">#  </span>
    <span class="c1"># Here the updated dataframe is only printed. </span>
    <span class="c1"># A more realistic use case is to simulate a model like this: </span>
    <span class="c1"># dummy_ = mpak(res,keep=&#39;Severity {serverity}&#39;)    # more realistic </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>input dataframe: 
               A           B      A_ORIG      B_ORIG
2020  100.000000  110.000000  100.000000  110.000000
2021  102.000000  112.200000  102.000000  112.200000
2022  109.040000  119.444000  104.040000  114.444000
2023  111.120800  121.732880  106.120800  116.732880
2024  113.343216  119.067538  108.243216  119.067538
2025  115.610080  121.448888  110.408080  121.448888


severity=0
Dataframe:
          A           B      A_ORIG      B_ORIG
2020  100.0  110.000000  100.000000  110.000000
2021  100.0  112.200000  102.000000  112.200000
2022  100.0  119.444000  104.040000  114.444000
2023  100.0  121.732880  106.120800  116.732880
2024  100.0  119.067538  108.243216  119.067538
2025  100.0  121.448888  110.408080  121.448888

Growth:
        A         B  A_ORIG  B_ORIG
2020  NaN       NaN     NaN     NaN
2021  0.0  2.000000     2.0     2.0
2022  0.0  6.456328     2.0     2.0
2023  0.0  1.916279     2.0     2.0
2024  0.0 -2.189501     2.0     2.0
2025  0.0  2.000000     2.0     2.0


severity=0.5
Dataframe:
               A           B      A_ORIG      B_ORIG
2020  100.000000  110.000000  100.000000  110.000000
2021  100.500000  117.200000  102.000000  112.200000
2022  101.505000  124.444000  104.040000  114.444000
2023  103.027575  126.732880  106.120800  116.732880
2024  105.088126  124.067538  108.243216  119.067538
2025  107.715330  126.448888  110.408080  121.448888

Growth:
        A         B  A_ORIG  B_ORIG
2020  NaN       NaN     NaN     NaN
2021  0.5  6.545455     2.0     2.0
2022  1.0  6.180887     2.0     2.0
2023  1.5  1.839285     2.0     2.0
2024  2.0 -2.103118     2.0     2.0
2025  2.5  1.919399     2.0     2.0


severity=1
Dataframe:
               A           B      A_ORIG      B_ORIG
2020  100.000000  110.000000  100.000000  110.000000
2021  101.000000  122.200000  102.000000  112.200000
2022  103.020000  129.444000  104.040000  114.444000
2023  106.110600  131.732880  106.120800  116.732880
2024  110.355024  129.067538  108.243216  119.067538
2025  115.872775  131.448888  110.408080  121.448888

Growth:
        A          B  A_ORIG  B_ORIG
2020  NaN        NaN     NaN     NaN
2021  1.0  11.090909     2.0     2.0
2022  2.0   5.927987     2.0     2.0
2023  3.0   1.768240     2.0     2.0
2024  4.0  -2.023293     2.0     2.0
2025  5.0   1.845042     2.0     2.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="upd-lprint-true-prints-values-the-before-and-after-update">
<h3><span class="section-number">4.1.20. </span>.upd(,,lprint=True ) prints values the before and after update<a class="headerlink" href="#upd-lprint-true-prints-values-the-before-and-after-update" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">lPrint</span></code> option of the method <code class="docutils literal notranslate"><span class="pre">upd()</span></code> is by defualt <code class="docutils literal notranslate"><span class="pre">=</span> <span class="pre">False</span></code>.  By setting it true an update command will output the results of the calculation comapriong the values of the dataframe (over the impacted period) before, after and the difference between the two.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1"># Same number of values as years</span>
<span class="s1">&lt;2021 2022&gt; A *  42 44</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span><span class="n">lprint</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Update * [42.0, 44.0] 2021 2022
A                    Before                After                 Diff
2021               102.0000            4284.0000            4182.0000
2022               109.0400            4797.7600            4688.7200
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>A_ORIG</th>
      <th>B_ORIG</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020</th>
      <td>100.000000</td>
      <td>110.000000</td>
      <td>100.000000</td>
      <td>110.000000</td>
    </tr>
    <tr>
      <th>2021</th>
      <td>4284.000000</td>
      <td>112.200000</td>
      <td>102.000000</td>
      <td>112.200000</td>
    </tr>
    <tr>
      <th>2022</th>
      <td>4797.760000</td>
      <td>119.444000</td>
      <td>104.040000</td>
      <td>114.444000</td>
    </tr>
    <tr>
      <th>2023</th>
      <td>111.120800</td>
      <td>121.732880</td>
      <td>106.120800</td>
      <td>116.732880</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>113.343216</td>
      <td>119.067538</td>
      <td>108.243216</td>
      <td>119.067538</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>115.610080</td>
      <td>121.448888</td>
      <td>110.408080</td>
      <td>121.448888</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="upd-create-true-requires-the-variable-to-exist">
<h3><span class="section-number">4.1.21. </span>.upd(,,create=True ) Requires the variable to exist<a class="headerlink" href="#upd-create-true-requires-the-variable-to-exist" title="Permalink to this headline">#</a></h3>
<p>Until now .upd has created variables if they did not exist in the input dataframe.</p>
<p>To catch misspellings the parameter <code class="docutils literal notranslate"><span class="pre">create</span></code> can be set to False.
New variables will not be created, and an exception will be raised.</p>
<p>Here Pythons exception handling is used, so the notebook will continue to run the cells below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    # Same number of values as years</span>
<span class="s1">    &lt;2021 2022&gt; Aa *  42 44</span>
<span class="s1">    &#39;&#39;&#39;</span><span class="p">,</span><span class="n">create</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">inst</span><span class="p">:</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variable to update not found:AA, timespan = [2021 2022] 
Set create=True if you want the variable created: 
</pre></div>
</div>
</div>
</div>
</section>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content\04_PythonEssentials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="PythonPandasDataframes.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Some Python basics</p>
      </div>
    </a>
    <a class="right-next"
       href="mfcalc.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.2. </span><code class="docutils literal notranslate"><span class="pre">.mfcalc()</span></code> an extension of standard Pandas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-method-of-modelflow">4.1. .upd() method of modelflow</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-method-operators">4.1.1. <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> method operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-some-examples">4.1.2. <code class="docutils literal notranslate"><span class="pre">.upd()</span></code> some examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-python-environment">4.1.3. Setting up the python environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-upd-to-create-a-new-variable-operator">4.1.4. Use .upd to create a new variable (= operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-updates-and-specific-time-periods">4.1.5. Multiple updates and specific time periods</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-specific-datapoints-to-specific-values">4.1.6. Setting specific datapoints to specific values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-the-specified-values-to-all-values-in-a-range-the-operator">4.1.7. Adding  the specified  values to all values in a range (the + operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplying-all-values-in-a-range-by-the-specified-values-the-operator">4.1.8. Multiplying all values in a range by the specified values (the * operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#increasing-all-values-in-a-range-by-a-specified-percent-amount-the-operator">4.1.9. Increasing all  values in a range by a  specified percent amount (the % operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-percent-growth-rate-to-specified-values-growth">4.1.10. Set the percent growth rate to specified values (=GROWTH)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-or-subtract-from-the-existing-percent-growth-rate-growth-operator">4.1.11. Add or subtract from the existing percent growth rate (+GROWTH operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-change-in-a-variable-to-specific-values-diff-operator">4.1.12. Set the change in a variable to specific values (=diff operator)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recall-that-we-have-not-overwritten-df-so-the-df-dataframe-is-unchanged">4.1.13. Recall  that we have not overwritten df, so the df dataframe is unchanged.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#keep-growth-rates-after-the-update-time-the-kg-option">4.1.14. Keep growth rates after the update time – the –kg option</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-default-keep-growth-behaviour">4.1.14.1. The default keep_growth behaviour</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-keep-growth-some-more-examples">4.1.15. .upd(,,,keep_growth) some more examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-a-new-dataframe-first-make-a-dataframe-with-some-growth-rate">4.1.16. Initialize a new dataframe First make a dataframe with some growth rate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#now-update-a-in-2021-to-2023-to-a-new-value">4.1.17. now update A in 2021 to 2023 to a new value</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-with-the-option-keep-growth-set-globally">4.1.17.1. .upd() with the option keep_growth set globally</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#update-several-variable-in-one-line">4.1.18. Update several variable in one line</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-scale-number-default-1-scale-the-updates">4.1.19. .upd(,,scale=&lt;number, default=1&gt;) Scale the updates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-lprint-true-prints-values-the-before-and-after-update">4.1.20. .upd(,,lprint=True ) prints values the before and after update</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upd-create-true-requires-the-variable-to-exist">4.1.21. .upd(,,create=True ) Requires the variable to exist</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andrew Burns and Ib Hansen
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright World Bank. 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>